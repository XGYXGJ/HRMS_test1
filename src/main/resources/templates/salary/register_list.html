<div class="container-fluid">
    <style>
        /* 统一搜索/刷新按钮的最小宽度，使它们视觉上等大
           若需要更精确对齐，可调整 min-width 值（例如 80-110px 区间） */
        .btn-uniform {
            min-width: 96px;
        }
    </style>
    <div class="d-flex justify-content-between mb-3 align-items-center">
        <h3>薪资发放历史</h3>

        <div class="d-flex align-items-center gap-2">
            <form class="d-flex" action="/salary/register/list" method="get">
                <input type="search"
                       name="registerCode"
                       class="form-control form-control-sm me-2"
                       placeholder="根据单号模糊搜索 (例如: PAY20251211)"
                       th:value="${registerCode}">
                <button type="submit" class="btn btn-primary btn-sm btn-uniform">搜索</button>
            </form>

            <button onclick="loadContent('/salary/register/list')" class="btn btn-outline-secondary btn-sm btn-uniform">刷新</button>
        </div>
    </div>

    <div th:if="${msg}" class="alert alert-success" th:text="${msg}"></div>
    <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

    <div class="card shadow-sm">
        <div class="card-body p-0">
            <table class="table table-striped mb-0">
                <thead class="table-dark">
                <tr>
                    <th>单号</th>
                    <th>所属月份</th>
                    <th>总人数</th>
                    <th>发放总金额</th>
                    <th>审核状态</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="reg : ${registers}">
                    <td th:text="${reg.registerCode}">PAY2025121101</td>

                    <td th:text="${#temporals.format(reg.payDate,'yyyy-MM')}">2025-12</td>

                    <td th:text="${reg.totalPeople}">10</td>
                    <td th:text="${reg.totalAmount}">150000.00</td>
                    <td>
                        <span th:if="${reg.auditStatus == 'Draft'}" class="badge bg-secondary">草稿</span>
                        <span th:if="${reg.auditStatus == 'Pending'}" class="badge bg-warning text-dark">待审核</span>
                        <span th:if="${reg.auditStatus == 'Approved'}" class="badge bg-success">已发放</span>
                        <span th:if="${reg.auditStatus == 'Rejected'}" class="badge bg-danger">已驳回</span>
                    </td>
                    <td>
                        <button th:if="${reg.auditStatus == 'Draft' or reg.auditStatus == 'Rejected'}"
                                th:onclick="|loadContent('/salary/register/draft-detail/${reg.registerId}')|"
                                class="btn btn-sm btn-warning">
                            录入绩效
                        </button>

                        <button th:if="${reg.auditStatus == 'Pending' or reg.auditStatus == 'Approved'}"
                                th:onclick="|loadContent('/salary/register/detail/${reg.registerId}')|"
                                class="btn btn-sm btn-primary">
                            查看明细
                        </button>

                        <button th:if="${reg.auditStatus == 'Draft'}"
                                th:data-id="${reg.registerId}"
                                th:data-code="${reg.registerCode}"
                                class="btn btn-sm btn-danger ms-2 btn-delete">
                            删除
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="modal fade" id="toastModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="toastTitle">提示</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="toastBody"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">知道了</button>
                </div>
            </div>
        </div>
    </div>

    <form id="deleteForm" method="post" action="" style="display: none;">
    </form>
</div>
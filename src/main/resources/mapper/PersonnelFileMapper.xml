<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.hrms.mapper.PersonnelFileMapper">

    <select id="selectFilesWithOrgName" resultType="java.util.Map">
        SELECT
            pf.File_ID AS fileId,
            pf.Archive_No AS archiveNo,
            pf.User_ID AS userId,
            pf.Name AS name,
            pf.Phone_Number AS phoneNumber,
            pf.Audit_Status AS auditStatus,
            pf.L3_Org_ID AS L3_Org_ID,
            o.Org_Name AS orgName,
            pos.Position_Name AS positionName   -- 【新增】查询职位名称
        FROM
            T_Personnel_File pf
                LEFT JOIN
            T_Organization o ON pf.L3_Org_ID = o.Org_ID
                LEFT JOIN
            T_User u ON pf.User_ID = u.User_ID  -- 【新增】关联用户表
                LEFT JOIN
            T_Position pos ON u.Position_ID = pos.Position_ID -- 【新增】关联职位表
        WHERE
            pf.Is_Deleted = 0
        ORDER BY
            pf.Creation_Time DESC
    </select>

</mapper>
